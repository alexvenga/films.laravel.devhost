<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    <script>
        /**
         * Yandex Suggest API
         */

        $(function() {
            var timer = null
                , timeout = 800;

            $('#js-av-search-place-name').on('keyup', function() {
                var value = $(this).val();

                clearTimeout(timer);

                timer = setTimeout(function() {
                    var $suggest = $('#js-av-search-place-name')
                        , $results = $('#js-av-search-place-name-results').removeClass('visible').empty()
                        , $close = $('#js-av-search-place-name-close');

                    // is empty value
                    if ($.trim(value) === '') {
                        return false;
                    }

                    var $ul = $('<ul/>').appendTo($results);

                    ymaps.suggest(value)
                        .then(function(items) {
                            console.log('SUGGESTED');
                            //$results.addClass('visible');
                            //$close.addClass('visible');

                            if (items.length > 0) {
                                items.map(function(item) {
                                    console.log(item);
                                    $ul.append($('<li/>').text(item.value));
                                });

                                $('li', $results).on('click', function() {
                                    $suggest.val($(this).text().trim());
                                    $results.empty();
                                });
                            } else {
                                $ul.append($('<li/>').addClass('message').text('No result found.'));
                            }

                            $close.on('click', function() {
                                $suggest.val($(this).text().trim());
                                $results.empty();
                                $results.removeClass('visible');
                                $close.removeClass('visible');
                                timer = null;
                            });
                        })
                        .catch(function(err) {
                            throw err;
                        });
                }, timeout);
            });
        });
    </script>

</head>
<body>

<h1>Test Vladislav Katkaev</h1>

<form>
    <input type="text" name="place" id="js-av-search-place-name" autocomplete="off">
    <div id="js-av-search-place-name-results">


    </div>

    <div id="#js-av-search-place-name-close">
        Закрыть
    </div>
    <button type="submit" id="js-av-search-place-name-button">НАйти</button>
</form>

</body>
</html>
